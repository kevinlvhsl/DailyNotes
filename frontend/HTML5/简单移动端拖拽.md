## 在页面中做一个 可拖动的按钮
> 主要用到touch事件(pc端可以用click+mousemove)
> 主要思路：普通状态下， 按钮可以点击，然后做一些事情（比如跳转，或弹窗等等）
> 可以保存一个全局状态，当按钮长按的时候，就给按钮设置为激活状态，这个时候移动手指或鼠标，则可以拖动这里主要举例移动端案例

+ 页面结构 jade
```
div.wailian(
    v-el:drag,
    :class="{'doudou': taping}",
    @click="tapEvent")
// 在整个应用最顶层，所有页面都能够显示按钮
<template lang="jade">
    #app
        router-view.view()
        .wailian(v-el:drag, :class="{'doudou': taping}", v-if="!isIndex", @click="tapEvent", draggable=true)
</template>
```
+ 样式 sass
```
html,body
    height: 100%
    min-height: rem(504)
    max-height: rem(504)
    overflow: hidden
*
    user-select: none
    -webkit-touch-callout: none
    touch-callout: none

.view-transition
    transition: all .3s ease
.view-leave
    opacity: .2
    transform: scale(.95) translate(0, 10px)
.view-enter
    opacity: .4
    transform: scale(.95) translate(0, 10px)
.view
    position: absolute
    top: 0
    bottom: 0
    left: 0
    width: 100%
    font-family: '微软雅黑'
    min-height: 504px
*
    user-select: none
    -webkit-touch-callout: none
    touch-callout: none
#app
    height: 100%

    .wailian
        position: absolute
        top: 345px
        left: 0px
        z-index: 5
        height: r(180)
        width: r(156)
        border-radius: 50%
        box-shadow: 0 5px 5px -5px rgba(0, 0, 0, .5)
        background:
            image: u('btn-hadprize.png')
            size: 100% 100%
            repeat: no-repeat
        &.doudou
            animation: doudong .2s infinite

@keyframes doudong
    25%
        transform: rotate(2deg)
    50%
        transform: rotate(0deg)
    75%
        transform: rotate(-2deg)
```
+ 脚本逻辑 js( vue + es6 ) vue组件开发 
```
<template lang="jade">
#this_removable_btn(
    v-if="isShow",
    v-el:drag,
    :class="{'active-shake': taping}",
    :style="initStyle",
    @click="tapEvent")
    .tip-to-move(
        v-if="isIos && tipShow"
    ) ↑长按图标可以拖动哦

</template>
<script>
export default {
    name: 'button',
    props: ['isShow', 'initStyle', 'clickEvent'],
    data() {
        return {
            tipShow: true,
            taping: false,
            body: document.getElementsByTagName('body')[0],
            isIos: App.isIos
        }
    },
    methods: {
        tapEvent(e){
            this.$dispatch(this.clickEvent)
        },
        dragEvent () {
            let btn = this.$els.drag
            let btnBox = {
                w: btn.offsetWidth,
                h: btn.offsetHeight
            }
            let bodyBox = {
                maxW: this.body.offsetWidth - btnBox.w / 2,
                maxH: this.body.offsetHeight - btnBox.h / 2
            }
            let moved = {x: 0, y: 0}
            let last = {
                x: btn.offsetLeft,
                y: btn.offsetTop
            }

            if (this.isIos && btn) {
                btn.addEventListener('touchstart', (event) => {
                    setTimeout(()=>{
                        this.taping = true
                    }, 1500)
                    console.log('touchstart')
                }, false)

                btn.addEventListener('touchmove', (event) => {
                    event.preventDefault()
                    event.stopPropagation()
                    if (this.taping) {
                        let touch = event.targetTouches[0]
                        let currentX = touch.clientX
                        let currentY = touch.clientY

                        if (currentX < btnBox.w / 2) currentX = btnBox.w / 2
                        if (currentY < btnBox.h /2) currentY = btnBox.h /2
                        if (currentX > bodyBox.maxW) currentX = bodyBox.maxW
                        if (currentY > bodyBox.maxH) currentY = bodyBox.maxH

                        btn.style.top = (currentY - btnBox.h / 2) + 'px'
                        btn.style.left = (currentX - btnBox.w / 2) + 'px'
                        this.tipShow = false
                    }
                }, false)

                btn.addEventListener('touchend', (event) => {
                    this.taping = false
                    console.log('touchend')
                }, false)

            }
        }
    },
    computed: {},
    ready () {
        this.dragEvent()
    },
    created () {},
    destroyed () {}
}
</script>
<style lang="sass">
#this_removable_btn
    user-select: none
    -webkit-touch-callout: none
    touch-callout: none
    position: absolute
    top: 0px
    left: 0px
    z-index: 5
    transform: translate3d(0, 0, 0)
    // border-radius: 50%
    // box-shadow: 0 5px 5px -5px rgba(0, 0, 0, .5)
    background:
        // image: url('../images/btn-hadprize.png')
        size: 100% 100%
        repeat: no-repeat
    &.active-shake
        animation: doudong .2s infinite
    .tip-to-move
        position: absolute
        bottom: -32px
        left: 5px
        width: 5em
        font-size: 12px
        color: #fff
@keyframes doudong
    25%
        transform: rotate(2deg)
    50%
        transform: rotate(0deg)
    75%
        transform: rotate(-2deg)
</style>
```
