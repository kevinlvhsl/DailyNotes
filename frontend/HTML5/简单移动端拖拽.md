## 在页面中做一个 可拖动的按钮
> 主要用到touch事件(pc端可以用click+mousemove)
> 主要思路：普通状态下， 按钮可以点击，然后做一些事情（比如跳转，或弹窗等等）
> 可以保存一个全局状态，当按钮长按的时候，就给按钮设置为激活状态，这个时候移动手指或鼠标，则可以拖动这里主要举例移动端案例

+ 页面结构 jade
```
div.wailian(
    v-el:drag,
    :class="{'doudou': taping}",
    @click="tapEvent")
// 在整个应用最顶层，所有页面都能够显示按钮
<template lang="jade">
    #app
        router-view.view()
        .wailian(v-el:drag, :class="{'doudou': taping}", v-if="!isIndex", @click="tapEvent", draggable=true)
</template>
```
+ 样式 sass
```
html,body
    height: 100%
    min-height: rem(504)
    max-height: rem(504)
    overflow: hidden
*
    user-select: none
    -webkit-touch-callout: none
    touch-callout: none

.view-transition
    transition: all .3s ease
.view-leave
    opacity: .2
    transform: scale(.95) translate(0, 10px)
.view-enter
    opacity: .4
    transform: scale(.95) translate(0, 10px)
.view
    position: absolute
    top: 0
    bottom: 0
    left: 0
    width: 100%
    font-family: '微软雅黑'
    min-height: 504px
*
    user-select: none
    -webkit-touch-callout: none
    touch-callout: none
#app
    height: 100%

    .wailian
        position: absolute
        top: 345px
        left: 0px
        z-index: 5
        height: r(180)
        width: r(156)
        border-radius: 50%
        box-shadow: 0 5px 5px -5px rgba(0, 0, 0, .5)
        background:
            image: u('btn-hadprize.png')
            size: 100% 100%
            repeat: no-repeat
        &.doudou
            animation: doudong .2s infinite

@keyframes doudong
    25%
        transform: rotate(2deg)
    50%
        transform: rotate(0deg)
    75%
        transform: rotate(-2deg)
```
+ 脚本逻辑 js( vue + es6 )
```

export default {
    data () {
        return {
            taping: false,
            adLink: 'http://m.sujiu99.com/wap/specialevent/walking-spot-signin?biz_username=gh_bf84d2a5e839&id=mDDDfq-K8GjI31xt-lFj1A&signinSourceId=1&from=singlemessage&isappinstalled=0'
        }
    },
    methods: {
        tapEvent(e){
            window.location.href = this.adLink
        },
        resetLastPoint (last, moved) {
            let $btn = $('.wailian').eq(0)
            let harfH = $btn.height() / 2
            let harfW = $btn.width() / 2
            last.x = moved.x + last.x
            last.y += moved.y
            $btn.css('top', (last.y - harfH) + 'px')
            $btn.css('left', (last.x - harfW) + 'px')
            this.$broadcast('moved')
        },
        dragEvent () {
            let div = this.$els.drag
            let $div = $('.wailian').eq(0)
            let moved = {x: 0, y: 0}
            let h = $div.height()
            let w = $div.width()
            let box = {
                maxW: $('body').width() - w / 2,
                maxH: $('body').height() - h / 2
            }
            console.error(w,h,box.maxW, box.maxH)
            let last = {
                    x: parseInt($div.css('left')),
                    y: parseInt($div.css('top'))
                 }
            div.addEventListener('touchstart', (event) => {
                setTimeout(()=>{
                    this.taping = true
                }, 1500)
                console.log('touchstart')
            }, false)
            div.addEventListener('touchmove', (event) => {
                event.preventDefault()
                event.stopPropagation()
                if (this.taping) {
                    let touch = event.targetTouches[0]
                    let currentX = touch.clientX
                    let currentY = touch.clientY
                    console.log(currentX, currentY)
                    if (currentX < w / 2) {
                        currentX = w / 2
                    }
                    if (currentY < h /2) {
                        currentY = h /2
                    }
                    if (currentX > box.maxW) {
                        currentX = box.maxW
                    }
                    if (currentY > box.maxH) {
                        currentY = box.maxH
                    }
                    moved.x = currentX - last.x
                    moved.y = currentY - last.y
                    this.resetLastPoint(last, moved)
                }
            }, false)

            div.addEventListener('touchend', (event) => {
                this.taping = false
                console.log('touchend')
            }, false)

        }
    },
    ready () {
        this.dragEvent()
    }
}

```
